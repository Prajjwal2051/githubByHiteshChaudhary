another fixes have been made in green-mode.

another fixes have been made in purple-mode.